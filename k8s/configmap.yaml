---
# CPG2PVG-AI Configuration
apiVersion: v1
kind: ConfigMap
metadata:
  name: cpg2pvg-ai-config
  namespace: cpg2pvg-ai
  labels:
    app.kubernetes.io/name: cpg2pvg-ai
    app.kubernetes.io/component: config
data:
  # Application Configuration
  PROJECT_NAME: "CPG2PVG-AI"
  PROJECT_DESCRIPTION: "将临床医学指南转化为公众医学指南的智能系统"
  VERSION: "1.0.0"
  ENVIRONMENT: "production"

  # API Configuration
  API_V1_STR: "/api/v1"
  ALLOWED_HOSTS: "localhost,127.0.0.1,0.0.0.0"
  CORS_ORIGINS: "https://cpg2pvg-ai.com"

  # Database Configuration
  POSTGRES_HOST: "postgres-service"
  POSTGRES_PORT: "5432"
  POSTGRES_DB: "cpg2pvg_ai"
  POSTGRES_USER: "cpg2pvg_user"
  POSTGRES_SSL_MODE: "require"
  POSTGRES_POOL_SIZE: "20"
  POSTGRES_MAX_OVERFLOW: "30"

  # Redis Configuration
  REDIS_HOST: "redis-service"
  REDIS_PORT: "6379"
  REDIS_DB: "0"
  REDIS_SSL: "true"
  REDIS_PASSWORD: ""

  # MinIO Configuration
  MINIO_HOST: "minio-service"
  MINIO_PORT: "9000"
  MINIO_SSL: "true"
  MINIO_SECURE: "false"
  MINIO_BUCKET: "cpg2pvg-storage"

  # Celery Configuration
  CELERY_BROKER_URL: "redis://redis-service:6379/0"
  CELERY_RESULT_BACKEND: "redis://redis-service:6379/0"
  CELERY_WORKER_CONCURRENCY: "4"
  CELERY_WORKER_PREFETCH_MULTIPLIER: "1"
  CELERY_TASK_ACKS_LATE: "true"
  CELERY_WORKER_DISABLE_RATE_LIMITS: "false"

  # File Configuration
  MAX_FILE_SIZE: "52428800"  # 50MB
  UPLOAD_DIR: "/app/uploads"
  OUTPUT_DIR: "/app/outputs"
  TEMP_DIR: "/app/temp"
  BACKUP_DIR: "/app/backups"

  # Logging Configuration
  LOG_LEVEL: "INFO"
  LOG_FORMAT: "json"
  LOG_STRUCTURED: "true"

  # Performance Configuration
  WORKER_TIMEOUT: "3600"  # 1 hour
  MAX_CONCURRENT_TASKS: "10"
  TASK_SOFT_TIME_LIMIT: "3000"  # 50 minutes
  TASK_TIME_LIMIT: "3600"  # 1 hour

  # OpenAI Configuration
  OPENAI_MODEL: "gpt-4"
  OPENAI_MAX_TOKENS: "4000"
  OPENAI_TEMPERATURE: "0.1"
  OPENAI_TIMEOUT: "60"

  # Health Check Configuration
  HEALTH_CHECK_INTERVAL: "30"
  HEALTH_CHECK_TIMEOUT: "10"
  HEALTH_CHECK_RETRIES: "3"
  HEALTH_CHECK_START_PERIOD: "30"

  # Monitoring Configuration
  METRICS_ENABLED: "true"
  METRICS_PORT: "9090"
  JAEGER_ENABLED: "true"
  JAEGER_ENDPOINT: "http://jaeger-service:14268/api/traces"

  # Security Configuration
  AUTH_ENABLED: "true"
  JWT_SECRET: "your-jwt-secret-change-in-production"
  JWT_ALGORITHM: "HS256"
  JWT_EXPIRE_MINUTES: "30"
  REFRESH_TOKEN_EXPIRE_DAYS: "7"